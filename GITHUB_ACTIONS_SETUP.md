# üöÄ GitHub Actions Setup Guide

## üìã **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ CI/CD –¥–ª—è CloudBridge Client**

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å GitHub Actions –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–±–æ—Ä–∫–∏, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è CloudBridge Client.

---

## üîß **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –°–µ–∫—Ä–µ—Ç–æ–≤ –≤ GitHub**

### **1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:**
```
Settings ‚Üí Secrets and variables ‚Üí Actions
```

### **2. –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ–∫—Ä–µ—Ç—ã:**

#### **üîê –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã:**
- **`JWT_SECRET`** - –û—Å–Ω–æ–≤–Ω–æ–π JWT —Å–µ–∫—Ä–µ—Ç –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤
- **`FALLBACK_SECRET`** - Fallback —Å–µ–∫—Ä–µ—Ç –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤ —Å `kid: "fallback-key"`

#### **üåê –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã:**
- **`RELAY_HOST`** - –•–æ—Å—Ç relay —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `edge.2gc.ru`)
- **`TEST_JWT_TOKEN`** - –¢–µ—Å—Ç–æ–≤—ã–π JWT —Ç–æ–∫–µ–Ω –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **`STAGING_HOST`** - –•–æ—Å—Ç –¥–ª—è staging —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- **`PRODUCTION_HOST`** - –•–æ—Å—Ç –¥–ª—è production —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### **3. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
```
Settings ‚Üí Secrets and variables ‚Üí Actions ‚Üí Variables
```

#### **üìä –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
- **`GO_VERSION`** - –í–µ—Ä—Å–∏—è Go (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `1.25`)
- **`RELAY_PORT`** - –ü–æ—Ä—Ç relay —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `9090`)

---

## üèóÔ∏è **Workflow –§–∞–π–ª—ã**

### **1. `build.yml` - –°–±–æ—Ä–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ –¥–ª—è Linux, Windows, macOS
- ‚úÖ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∏ –ª–∏–Ω—Ç–µ—Ä–∞
- ‚úÖ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–ª–∏–∑–æ–≤

### **2. `deploy.yml` - –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ**
- ‚úÖ –†—É—á–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ staging/production
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ deployment –ø–∞–∫–µ—Ç–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ systemd —Å–µ—Ä–≤–∏—Å–æ–≤

### **3. `test-with-secrets.yml` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏**
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ JWT –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ relay —Å–µ—Ä–≤–µ—Ä—É
- ‚úÖ –ü–æ–ª–Ω–æ–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üöÄ **–ó–∞–ø—É—Å–∫ Workflows**

### **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã:**
- **Push –≤ main/develop** ‚Üí –ó–∞–ø—É—Å–∫ —Å–±–æ—Ä–∫–∏ –∏ —Ç–µ—Å—Ç–æ–≤
- **Pull Request** ‚Üí –ó–∞–ø—É—Å–∫ —Å–±–æ—Ä–∫–∏ –∏ —Ç–µ—Å—Ç–æ–≤
- **Release** ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–ª–∏–∑–∞ —Å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º–∏

### **–†—É—á–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã:**
- **Deploy** ‚Üí –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å—Ä–µ–¥—É
- **Test with Secrets** ‚Üí –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Å–µ–∫—Ä–µ—Ç–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏

---

## üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**

### **‚úÖ –ß—Ç–æ –∑–∞—â–∏—â–µ–Ω–æ:**
- –í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ GitHub Secrets
- –°–µ–∫—Ä–µ—Ç—ã –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –≤—ã–≤–æ–¥–µ
- –î–æ—Å—Ç—É–ø –∫ —Å–µ–∫—Ä–µ—Ç–∞–º —Ç–æ–ª—å–∫–æ –¥–ª—è authorized workflows
- Environment-specific —Å–µ–∫—Ä–µ—Ç—ã

### **‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:**
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ –∫–æ–¥
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ environment-specific —Å–µ–∫—Ä–µ—Ç—ã
- –†–µ–≥—É–ª—è—Ä–Ω–æ —Ä–æ—Ç–∏—Ä—É–π—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ —Å–µ–∫—Ä–µ—Ç–∞–º

---

## üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**

### **–°—Ç–∞—Ç—É—Å —Å–±–æ—Ä–æ–∫:**
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç—É—Å –≤ —Ä–∞–∑–¥–µ–ª–µ "Actions"
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ failed builds
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### **–õ–æ–≥–∏:**
- –í—Å–µ –ª–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ GitHub Actions
- –°–µ–∫—Ä–µ—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–∞—Å–∫–∏—Ä—É—é—Ç—Å—è
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞–∂–¥–æ–º —à–∞–≥–µ

---

## üõ†Ô∏è **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞**

### **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ workflows –ª–æ–∫–∞–ª—å–Ω–æ:**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ act –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
npm install -g @nektos/act

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ workflow –ª–æ–∫–∞–ª—å–Ω–æ
act -s JWT_SECRET="your-secret" -s FALLBACK_SECRET="your-fallback"
```

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å YAML
yamllint .github/workflows/*.yml

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Go –∫–æ–¥
golangci-lint run
```

---

## üéØ **–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**

### **1. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ staging:**
```
Actions ‚Üí Deploy CloudBridge Client ‚Üí Run workflow
Environment: staging
Version: latest
```

### **2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ JWT:**
```
Actions ‚Üí Test with Secrets ‚Üí Run workflow
Test Type: jwt
```

### **3. –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```
Actions ‚Üí Test with Secrets ‚Üí Run workflow
Test Type: full
```

---

## üîß **Troubleshooting**

### **–ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

#### **1. –°–µ–∫—Ä–µ—Ç—ã –Ω–µ –¥–æ—Å—Ç—É–ø–Ω—ã:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ–∫—Ä–µ—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ workflow –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Å–µ–∫—Ä–µ—Ç–∞–º
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é

#### **2. –°–±–æ—Ä–∫–∞ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é Go
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å Go –∫–æ–¥–∞

#### **3. –¢–µ—Å—Ç—ã –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ —Å–µ–∫—Ä–µ—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

---

## üìö **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã**

- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [GitHub Secrets Documentation](https://docs.github.com/en/actions/security-guides/encrypted-secrets)
- [Go GitHub Actions](https://github.com/actions/setup-go)
- [Security Best Practices](https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions)

---

## üéâ **–ì–æ—Ç–æ–≤–æ!**

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –≤–∞—à CloudBridge Client –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –°–æ–±–∏—Ä–∞—Ç—å—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º push
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Å–µ–∫—Ä–µ—Ç–∞–º–∏
- ‚úÖ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞—Ç—å—Å—è –≤ staging/production
- ‚úÖ –°–æ–∑–¥–∞–≤–∞—Ç—å —Ä–µ–ª–∏–∑—ã —Å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º–∏

**–£–¥–∞—á–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏!** üöÄ
